/*!
 * Field Drop Js v1.0.0 (May 20th 2017)
 * FieldDrop.js is an JavaScript library that provides drag and drop file uploads with image previews
 * 
 * https://github.com/dejaneves/fieldDrop.js#readme
 * 
 * Licensed MIT Â© Jaime Neves
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).FieldDrop=e()}}(function(){return function e(t,n,i){function o(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(r)return r(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return o(n||e)},d,d.exports,e,t,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(e,t,n){function i(){}i.prototype={on:function(e,t,n){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){function i(){o.off(e,i),t.apply(n,arguments)}var o=this;return i._=t,this.on(e,i,n)},emit:function(e){var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),i=0,o=n.length;for(i;i<o;i++)n[i].fn.apply(n[i].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),i=n[e],o=[];if(i&&t)for(var r=0,s=i.length;r<s;r++)i[r].fn!==t&&i[r].fn._!==t&&o.push(i[r]);return o.length?n[e]=o:delete n[e],this}},t.exports=i},{}],2:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){i(this,e)}return o(e,[{key:"get",value:function(e,t){var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return n.open("GET",e),n.onreadystatechange=function(){n.readyState>3&&200===n.status&&t(n.responseText)},n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(),n}},{key:"post",value:function(e,t,n){"string"==typeof t||Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&");var i=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return i.open("POST",e),i.onreadystatechange=function(){i.readyState>3&&200===i.status&&n(i.responseText)},i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(t),i}},{key:"upload",value:function(e,t,n){var i=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),o=document.querySelector("progress");return i.open("POST",e),i.onreadystatechange=function(){n(i.readyState>3&&200===i.status?i.responseText:i)},i.onprogress=function(e){if(e.lengthComputable){var t=e.loaded/e.total*100|0;o.value=o.innerHTML=t}},i.onload=function(){o.value=o.innerHTML=100},i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.send(t),i}}]),e}();n.default=r},{}],3:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=i(e("./ajax")),d=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(i.element=e,i.trigger=null,i.ajax=new l.default,i.defaults={url:"",selector:'input[type="file"]',eventListener:"change",deleteOptions:{htmlText:"Delete"}},i.divItems=document.createElement("div"),i.divProgress=document.createElement("progress"),i.fieldDrop_content=".field-drop--content",i.fieldDrop_uploads=".field-drop--uploads",!i.element)throw new Error("error");return"string"==typeof i.element&&(i.element=document.querySelector(i.element)),"object"===(void 0===n?"undefined":a(n))?i.options=Object.assign({},i.defaults,n):i.options=i.defaults,i.init(),i}return s(t,e),u(t,[{key:"init",value:function(){this.mountTemplate(this.element),this.bindEvent()}},{key:"createActionDelete",value:function(e,t){this.emit("delete",e,t)}},{key:"createActionSend",value:function(e){this.emit("send",e)}},{key:"setAttrItem",value:function(e,t){var n="div[data-name='"+e+"']";document.querySelector(n).setAttribute("data-response",t)}},{key:"mountTemplate",value:function(e){var t=document.createElement("div"),n=document.createElement("div");t.setAttribute("class",this.fieldDrop_content.replace(".","")),t.innerHTML='<div class="drag-and-drop-info"><span class="title">Drop files here</span><span class="icon"></span></div><input type="button" id="fake-button" onclick="document.getElementById(\'file-input\').click();" value="Select File ..."> <input type="file" name="file" id="file-input" style="display:none">',n.setAttribute("class",this.fieldDrop_uploads.replace(".","")),this.divProgress.setAttribute("id","upload-progress"),this.divProgress.setAttribute("min",0),this.divProgress.setAttribute("max",100),this.divProgress.setAttribute("value",0),this.divProgress.setAttribute("class","hide"),this.divProgress.innerHTML="0",e.appendChild(t),e.appendChild(n),this.trigger=e.querySelector(this.options.selector)}},{key:"EventDelete",value:function(){var e=this;this.element.querySelector(".field-drop--uploads .uploads__item .delete").addEventListener("click",function(t){t.preventDefault();var n=t.target.parentNode.parentNode.parentNode;n.remove();var i=n.getAttribute("data-name"),o=n.getAttribute("data-response");e.element.querySelector(e.fieldDrop_content).classList.remove("hide"),e.createActionDelete(i,o)})}},{key:"bindEvent",value:function(){var e=this,t=this.element;this.trigger.addEventListener("change",function(t){e.workPhoto(t.target.files)}),this.element.addEventListener("dragover",function(e){e.stopPropagation(),e.preventDefault(),t.classList.add("selected-area")},!1),this.element.addEventListener("dragenter",function(e){e.stopPropagation(),e.preventDefault(),t.classList.add("selected-area")},!1),this.element.addEventListener("dragend",function(e){t.classList.remove("selected-area")},!1),this.element.addEventListener("dragleave",function(e){t.classList.remove("selected-area")},!1),this.element.addEventListener("drop",function(t){t.stopPropagation(),t.preventDefault(),e.workPhoto(t.dataTransfer.files)},!1)}},{key:"workPhoto",value:function(e){this.renderPhoto(e)}},{key:"renderPhoto",value:function(e){var t=/image.*/,n=new FileReader,i=new Image,o=this.element.querySelector(this.fieldDrop_uploads),r=this.humanFileSize(e[0].size),s=this;this.divItems.setAttribute("class","uploads__item"),this.divItems.setAttribute("data-name",e[0].name);var a='<div class="item--image"></div><div class="item--info"><div class="info--name">'+e[0].name+'</div><div class="info--size">'+r+'</div><div class="info--actions"> <a href="#" class="delete" title="Delete"> '+this.options.deleteOptions.htmlText+" </a> </div></div>";this.divItems.innerHTML="",this.divItems.innerHTML=a,e[0].type.match(t)&&(n.onload=function(t){i.src=n.result,s.divItems.querySelector(".item--image").innerHTML="",s.divItems.querySelector(".item--image").appendChild(i),o.appendChild(s.divItems),s.EventDelete(),s.createActionSend(e)}),n.readAsDataURL(e[0]),this.hideContenContainer()}},{key:"hideContenContainer",value:function(){this.element.querySelector(this.fieldDrop_content).classList.add("hide")}},{key:"sendFile",value:function(e,t){this.ajax.upload(this.options.url,e,function(e){t(e)})}},{key:"humanFileSize",value:function(e){var t=Math.floor(Math.log(e)/Math.log(1024));return 1*(e/Math.pow(1024,t)).toFixed(2)+" "+["B","kB","MB","GB","TB"][t]}}]),t}(i(e("tiny-emitter")).default);t.exports=d},{"./ajax":2,"tiny-emitter":1}]},{},[3])(3)});